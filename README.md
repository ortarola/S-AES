# S-AES
本项目为重庆大学大数据与软件学院信息安全导论课程作业2：SAES算法实现。

### 1.算法实现

我们的S-AES算法实现在S_AES.py文件中。

attack.py文件实现中间相遇攻击算法。

CBC_work.py文件实现CBC工作模式加密算法。

double.py文件实现双重加密算法。

GUI.py文件实现操作页面。

triple.py文件实现三重加密算法。


### 2.GUI设计

我们基于python设计了一个比较简洁但交互良好的界面。

![img.png](img%2Fimg.png)

### 3.编程和测试要求



#### 1.基本测试


###### 根据S-AES算法编写和调试程序，提供GUI解密支持用户交互。输入可以是16bit的数据和16bit的密钥，输出是16bit的密文。

加密

![img2.png](img%2Fimg2.png)

解密

![img3.png](img%2Fimg3.png)

#### 2.交叉测试

###### 设有A和B两组位同学(选择相同的密钥K)；则A、B组同学编写的程序对明文P进行加密得到相同的密文C；或者B组同学接收到A组程序加密的密文C，使用B组程序进行解密可得到与A相同的P。

我组

![img3.png](img%2Fimg3.png)

别组

![img11.png](img%2Fimg11.png)

#### 3.扩展功能

###### 考虑到向实用性扩展，加密算法的数据输入可以是ASII编码字符串(分组为2 Bytes)，对应地输出也可以是ACII字符串(很可能是乱码)。

![img4.png](img%2Fimg4.png)

#### 4.多重加密

##### 3.4.1 双重加密

###### 将S-AES算法通过双重加密进行扩展，分组长度仍然是16 bits，但密钥长度为32 bits。

加密

![img5.png](img%2Fimg5.png)

解密

![img6.png](img%2Fimg6.png)

##### 3.4.2 中间相遇攻击

###### 假设你找到了使用相同密钥的明、密文对(一个或多个)，请尝试使用中间相遇攻击的方法找到正确的密钥Key(K1+K2)。

模拟中间相遇攻击我们需要遍历所有可能的密钥，然后用每一个可能的密钥进行解密操作，检查解密后的结果是否是预期的明文即可。
当我们只拥有一个明密文对时,可能有上万个密钥满足情况。而当我们掌握了2~3个明密文对的时候就完全能够锁定密钥（当明密文对的结构太过于相似时会出现两对明密文无法解密出正确的key）。

![img9.png](img%2Fimg9.png)

##### 3.4.3 三重加密

###### 将S-AES算法通过三重加密进行扩展，下面两种模式选择一种完成：

###### (1)按照32 bits密钥Key(K1+K2)的模式进行三重加密解密，

###### (2)使用48bits(K1+K2+K3)的模式进行三重加解密。

我们选择第二种模式来完成。

加密

![img7.png](img%2Fimg7.png)

解密

![img8.png](img%2Fimg8.png)

#### 5.工作模式

###### 基于S-AES算法，使用密码分组链(CBC)模式对较长的明文消息进行加密。注意初始向量(16 bits) 的生成，并需要加解密双方共享。
###### 在CBC模式下进行加密，并尝试对密文分组进行替换或修改，然后进行解密，请对比篡改密文前后的解密结果。

![img10.png](img%2Fimg10.png)
